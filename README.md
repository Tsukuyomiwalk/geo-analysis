# Предварительная обработка данных

## Описание файла test_models.py

Этот файл автоматизирует процесс обучения моделей машинного обучения, настройки гиперпараметров и выбора наилучшей
модели для прогнозирования целевой переменной на основе входных данных.

### Шаги предварительной обработки данных

1. **Загрузка данных**: Загружаются обучающие и тестовые данные, а также дополнительные признаки из CSV-файлов.
2. **Создание новых признаков**: На основе координат широты и долготы создаются новые признаки с помощью агрегации
   данных.
3. **Объединение данных**: Данные объединяются, а лишние признаки удаляются.

### Используемые модели

1. Случайный лес (Random Forest)
2. Метод опорных векторов (Support Vector Machine)
3. Дерево решений (Decision Tree)
4. CatBoost
5. Стекинг (ансамбль из Линейной регрессии, Случайного леса, Метода опорных векторов и Дерева решений)
6. Lasso регрессия

### Шаги обучения и оценки моделей

1. **Обучение моделей**: Модели обучаются на предварительно обработанных данных.
2. **Оценка производительности**: Используется отрицательное среднее абсолютное отклонение (MAE) для оценки
   производительности моделей с помощью GridSearchCV.
3. **Выбор лучшей модели**: Выбирается модель с наименьшим значением MAE на обучающих данных.

### Шаги сохранения

1. **Сохранение модели**: Обученная модель сохраняется с использованием pickle для последующего использования на новых
   данных.
2. **Сохранение селектора**: Селектор также сохраняется с использованием pickle.

## Описание файла submission.py
Этот файл предназначен для использования обученной модели и селектора на новых данных для создания прогнозов и подготовки файла сабмита.

## Основные шаги
1. **Загрузка данных**: Загружаются тестовые данные и дополнительные признаки из CSV-файлов.
2. **Объединение данных**: Тестовые данные объединяются с дополнительными признаками на основе координат широты и долготы.
3. **Подготовка данных**: Удаляются идентификаторы и применяется селектор признаков к тестовым данным.
4. **Загрузка модели и селектора**: Загружаются обученная модель и селектор из сохраненных файлов.
5. **Предсказание**: Проводится предсказание на тестовых данных с использованием загруженной модели и селектора.
6. **Сохранение результата**: Результаты предсказания сохраняются в файл сабмита в формате CSV.

# Как использовать

1. Если хотите переобучить модель, то запустите файл `test_models.py`.
2. чтобы просто получить результат, то запустите файл `submission.py` для создания прогнозов на новых данных и подготовки файла сабмита.
